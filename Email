Sub SendMessage(Optional AttachmentPath)   Dim objOutlook As Outlook.Application   Dim objOutlookMsg As Outlook.MailItem   Dim objOutlookRecip As Outlook.Recipient   Dim objOutlookAttach As Outlook.Attachment   ' Create the Outlook session.   Set objOutlook = CreateObject("Outlook.Application")   ' Create the message.   Set objOutlookMsg = objOutlook.CreateItem(olMailItem)   With objOutlookMsg      ' Add the To recipient(s) to the message.     Set objOutlookRecip = .Recipients.Add("Kohler Ryan")      objOutlookRecip.Type = olTo      ' Add the CC recipient(s) to the message.      'Set objOutlookRecip = .Recipients.Add("Andrew Fuller")      'objOutlookRecip.Type = olCC      ' Set the Subject, Body, and Importance of the message.      .Subject = "This is an Automation test with Microsoft Outlook"      .Body = "Last test - I promise." & vbCrLf & vbCrLf      '.Importance = olImportanceHigh  'High importance      ' Add attachments to the message.      If Not IsMissing(AttachmentPath) Then         Set objOutlookAttach = .Attachments.Add(AttachmentPath)      End If      ' Resolve each Recipient's name.      For Each objOutlookRecip In .Recipients         objOutlookRecip.Resolve         If Not objOutlookRecip.Resolve Then         objOutlookMsg.Display      End If      Next      .Send   End With   Set objOutlookMsg = Nothing   Set objOutlook = NothingEnd Sub
