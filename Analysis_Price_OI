Private start_date As DatePrivate end_date As DatePrivate v_mavg() As LongPrivate iv_mat As SinglePrivate v_IV_var() As LongPrivate main_results As VariantSub main_sub()'''' get date rangestart_date = Sh_InputTech.Range("E3")end_date = Sh_InputTech.Range("E4")'''''''' get mavg rangeReDim v_mavg(0)n = 0For Each cell In Sh_InputTech.Range(Cells(3, 7), Cells(3, 7).End(xlDown))If v_mavg(0) = 0 Thenv_mavg(n) = CSng(cell)Elsen = n + 1ReDim Preserve v_mavg(n)v_mavg(n) = CSng(cell)End IfNext cell'''''''' fill in main_results with security namesReDim main_results(Sh_InputTech.Range(Cells(3, 2), Cells(3, 2).End(xlDown)).Count - 1, 3)For i = 3 To UBound(main_results, 1) + 3main_results(i - 3, 0) = Cells(i, 2)Next i'''' analyze price and Open Interest dataCall Functions.px_OI_analysis(main_results, end_date, start_date, v_mavg)'''' display to the 'General' SheetDim sh As WorksheetSet sh = Sh_Generalsh.Range("A1:AZ2000").ClearContentssh.Range("A1:AZ2000").ClearFormatsCall column_fmt(v_mavg, v_IV_var, sh)sh.ActivateCall lins(main_results, sh)sh.Range(Cells(2, 1), Cells(2 + UBound(main_results, 1), 1 + UBound(main_results, 2))) _    = main_resultsCells.EntireColumn.AutoFit'''' Display Analysis for Specifi sheets (52Wks, RSI...)Call Display.display_Highs(main_results)Call Display.display_Lows(main_results)Call display_RSI70(main_results)Call display_RSI30(main_results)Call Display.display_mavgUp(main_results)Call Display.display_mavgDown(main_results)Call Display.display_OI(main_results)Call Display.display_earnings(main_results)Application.StatusBar = FalseSh_General.ActivateEnd Sub
