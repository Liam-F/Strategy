Sub display_Highs(main_results As Variant)With sh_Highs .Cells.ClearContents .Cells.ClearFormats .Range("A1").Value = "Ticker" .Range("B1").Value = "Last Price"n = 0For i = 0 To UBound(main_results, 1)If main_results(i, 1) = "No data" Or main_results(i, 1) = "Ticker not found" Or _        main_results(i, 1) = "Last date not loaded" ThenElseIf CDbl(main_results(i, 2)) = 1 Thenn = n + 1.Cells(n + 1, 1).Value = main_results(i, 0).Cells(n + 1, 2).Value = main_results(i, 1).Cells(n + 1, 2).NumberFormat = "$#,##0.00"End IfEnd IfNext i.Activateformat_resultsEnd WithEnd SubSub display_Lows(main_results As Variant)With Sh_Low .Cells.ClearContents  .Cells.ClearFormats .Range("A1").Value = "Ticker" .Range("B1").Value = "Last Price"n = 0For i = 0 To UBound(main_results, 1)If main_results(i, 1) = "No data" Or main_results(i, 1) = "Ticker not found" Or _        main_results(i, 1) = "Last date not loaded" ThenElseIf CDbl(main_results(i, 2)) = 0 Thenn = n + 1.Cells(n + 1, 1).Value = main_results(i, 0).Cells(n + 1, 2).Value = main_results(i, 1).Cells(n + 1, 2).NumberFormat = "$#,##0.00"End IfEnd IfNext i.Activateformat_resultsEnd WithEnd SubSub display_RSI70(main_results As Variant)With sh_RSI70.Cells.ClearContents .Cells.ClearFormats.Range("A1").Value = "Ticker".Range("B1").Value = "RSI > 70%"n = 0For i = 0 To UBound(main_results, 1)If main_results(i, 3) <> "" ThenIf CDbl(main_results(i, 3)) >= 0.7 Thenn = n + 1.Cells(n + 1, 1).Value = main_results(i, 0).Cells(n + 1, 2).Value = main_results(i, 3).Cells(n + 1, 2).Style = "Percent"End IfEnd IfNext i.Activate.Range(Cells(1, 1), Cells(1, 2).End(xlDown)).SelectSelection.Sort Key1:=Range("B1"), Order1:=xlDescending, Header:=xlGuess, _        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _        DataOption1:=xlSortNormalformat_resultsEnd WithEnd SubSub display_RSI30(main_results As Variant)With sh_RSI30.Cells.ClearContents .Cells.ClearFormats.Range("A1").Value = "Ticker".Range("B1").Value = "RSI < 30%"n = 0For i = 0 To UBound(main_results, 1)If main_results(i, 3) <> "" ThenIf CDbl(main_results(i, 3)) <= 0.3 Thenn = n + 1.Cells(n + 1, 1).Value = main_results(i, 0).Cells(n + 1, 2).Value = main_results(i, 3).Cells(n + 1, 2).Style = "Percent"End IfEnd IfNext i.Activate.Range(Cells(1, 1), Cells(1, 2).End(xlDown)).SelectSelection.Sort Key1:=Range("B1"), Order1:=xlAscending, Header:=xlGuess, _        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _        DataOption1:=xlSortNormalformat_resultsEnd WithEnd SubSub display_mavgUp(main_results As Variant)With Sh_MavgUp .Cells.ClearContents  .Cells.ClearFormats .Range("A1").Value = "Ticker" .Range("B1").Value = "MAVG20 > 50" .Range("C1").Value = "MAVG100 > 50" .Range("D1").Value = "MAVG200 > 50"n = 0For i = 0 To UBound(main_results, 1)    For j = 0 To UBound(main_results, 2) - 1    If main_results(i, j) = "N/A" Or main_results(i, j) = "" Then    GoTo 1    End If    Next jIf CDbl(main_results(i, 17)) > 0 And _    CDbl(main_results(i, 18)) = 1 And _    CDbl(main_results(i, 11)) > CDbl(main_results(i, 8)) And _    CDbl(main_results(i, 14)) > CDbl(main_results(i, 8)) Thenn = n + 1.Cells(n + 1, 1).Value = main_results(i, 0).Cells(n + 1, 2).Value = "yes".Cells(n + 1, 3).Value = "yes".Cells(n + 1, 4).Value = "yes"End If1:Next i.Activateformat_resultsEnd WithEnd SubSub display_mavgDown(main_results As Variant)With Sh_MavgDown .Cells.ClearContents  .Cells.ClearFormats .Range("A1").Value = "Ticker" .Range("B1").Value = "MAVG20 < 50" .Range("C1").Value = "MAVG100 < 50" .Range("D1").Value = "MAVG200 < 50"n = 0For i = 0 To UBound(main_results, 1)    For j = 0 To UBound(main_results, 2) - 1    If main_results(i, j) = "N/A" Or main_results(i, j) = "" Then    GoTo 1    End If    Next j    If CDbl(main_results(i, 17)) < 0 And _    CDbl(main_results(i, 18)) = 1 And _    CDbl(main_results(i, 11)) < CDbl(main_results(i, 8)) And _    CDbl(main_results(i, 14)) < CDbl(main_results(i, 8)) Thenn = n + 1.Cells(n + 1, 1).Value = main_results(i, 0).Cells(n + 1, 2).Value = "yes".Cells(n + 1, 3).Value = "yes".Cells(n + 1, 4).Value = "yes"End If1:Next i.Activateformat_resultsEnd WithEnd SubSub display_OI(main_results As Variant)With Sh_OI .Cells.ClearContents  .Cells.ClearFormats .Range("A1").Value = "Ticker" .Range("B1").Value = "Last OI on Call > 10x Avg5d" .Range("C1").Value = "Last OI on Put > 10x Avg5d"n = 0For i = 0 To UBound(main_results, 1)    For j = 0 To UBound(main_results, 2) - 1    If main_results(i, j) = "N/A" Or main_results(i, j) = "" Then    GoTo 1    End If    Next j    If CDbl(main_results(i, 21)) > 10 Thenn = n + 1.Cells(n + 1, 1).Value = main_results(i, 0).Cells(n + 1, 2).Value = "yes"End IfIf CDbl(main_results(i, 24)) > 10 Then.Cells(n + 1, 1).Value = main_results(i, 0).Cells(n + 1, 3).Value = "yes"End If1:Next i.Activateformat_resultsEnd WithEnd SubSub display_earnings(main_results As Variant)With Sh_Earnings .Cells.ClearContents .Cells.ClearFormats .Range("A1").Value = "Ticker" .Range("B1").Value = "Earning Date" .Range("C1").Value = "Div Amount" n = 0For i = 0 To UBound(main_results, 1)    For j = 0 To UBound(main_results, 2) - 1    If main_results(i, j) = "N/A" Or main_results(i, j) = "" Then    GoTo 1    End If    Next j        'If DateValue((main_results(i, 28)(0, 0))) < Date + Sh_InputTech.Range("J2").Value ThenIf Abs(CDbl(CDate(main_results(i, 28)(0, 0))) - CDbl(Date)) <= Sh_InputTech.Range("J2").Value Then    If Not IsEmpty(main_results(i, 28)(0, 1)) Then'        If main_results(i, 28)(0, 1) <> "0" Then'        If main_results(i, 28)(0, 1) <> "0" Then        n = n + 1        .Cells(n + 1, 1).Value = main_results(i, 0)        .Cells(n + 1, 2).Value = main_results(i, 28)(0, 0)        .Cells(n + 1, 3).Value = main_results(i, 28)(0, 1)'        End If'    End If    Else    n = n + 1    .Cells(n + 1, 1).Value = main_results(i, 0)    .Cells(n + 1, 2).Value = main_results(i, 28)(0, 0)    .Cells(n + 1, 3).Value = "No BBG Data"    End IfEnd If1:Next i.Activate.Range(Cells(1, 1), Cells(1, 3).End(xlDown)).SelectSelection.Sort Key1:=Range("B1"), Order1:=xlAscending, Header:=xlGuess, _        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _        DataOption1:=xlSortNormal        format_resultsEnd WithEnd SubSub format_results()For Each cell In Range(Cells(1, 1), Cells(1, 1).End(xlToRight))cell.SelectWith Selection.Interior    .ColorIndex = 13    .Pattern = xlSolidEnd WithSelection.Font.ColorIndex = 2Selection.Font.Bold = TrueSelection.EntireColumn.AutoFitNext cellDim end_line As Integer: end_line = 501If Range("A2") <> "" Thenend_line = Range(Cells(1, 1), Cells(1, 1).End(xlDown)).CountEnd IfIf end_line > 500 ThenElseFor i = 3 To end_line Step 2Range(Cells(i, 1), Cells(i, 1).End(xlToRight)).Interior.Color = RGB(200, 255, 200)Next iEnd IfEnd Sub
