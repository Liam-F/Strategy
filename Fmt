Sub column_fmt(vv_m() As Long, vv_IV() As Long, sh As Worksheet)sh.Activatesh.Range("A1") = "Ticker"sh.Range("B1") = "Last Price"sh.Range(Cells(1, 1), Cells(1, 2)).Interior.ColorIndex = 36sh.Range("C1") = "52-Week Price Range"sh.Range("C1").Interior.ColorIndex = 37sh.Range("C1").EntireColumn.Style = "Percent"sh.Range("D1") = "RSI 14d"sh.Range("D1").Interior.ColorIndex = 37sh.Range("D1").EntireColumn.Style = "Percent"For i = 0 To UBound(vv_m)sh.Cells(1, 4 + (i * 3) + 1).Value = "MAVG" & vv_m(i)sh.Cells(1, 4 + (i * 3) + 2).Value = "Level" & vv_m(i)sh.Cells(1, 4 + (i * 3) + 2).EntireColumn.NumberFormat = "$#,##0.00"sh.Cells(1, 4 + (i * 3) + 3).Value = "Nbdays" & vv_m(i)Next ish.Range(Cells(1, 5), Cells(1, 4 + (i * 3))).Interior.Color = RGB(200, 200, 255)Dim last_column As Integer: last_column = Range(Cells(1, 1), Cells(1, 1).End(xlToRight)).Countsh.Cells(1, last_column + 1).Value = "MAVG" & vv_m(0) & "/" & vv_m(1)sh.Cells(1, last_column + 2).Value = "Level" & vv_m(0) & "/" & vv_m(1)sh.Cells(1, last_column + 2).EntireColumn.NumberFormat = "$#,##0.00"sh.Cells(1, last_column + 3).Value = "Nbdays" & vv_m(0) & "/" & vv_m(1)sh.Range(Cells(1, 4 + (i * 3) + 1), Cells(1, 5 + (i * 3) + 3)) _    .Interior.Color = RGB(255, 153, 0)    sh.Cells(1, last_column + 4).Value = "Last Call OI"sh.Cells(1, last_column + 5).Value = "Avg Call OI Last 5d"sh.Cells(1, last_column + 6).Value = "Ratio"sh.Cells(1, last_column + 6).EntireColumn.Style = "Percent"sh.Cells(1, last_column + 7).Value = "Last Put OI"sh.Cells(1, last_column + 8).Value = "Avg Put OI Last 5d"sh.Cells(1, last_column + 9).Value = "Ratio"sh.Cells(1, last_column + 9).EntireColumn.Style = "Percent"sh.Range(Cells(1, last_column + 4), Cells(1, last_column + 9)) _    .Interior.Color = RGB(255, 153, 204)sh.Cells(1, last_column + 10).Value = "Last CP ratio"sh.Cells(1, last_column + 10).EntireColumn.Style = "Percent"sh.Cells(1, last_column + 11).Value = "AVG CP Ratio"sh.Cells(1, last_column + 11).EntireColumn.Style = "Percent"sh.Cells(1, last_column + 12).Value = "Spread"sh.Cells(1, last_column + 12).EntireColumn.Style = "Percent"sh.Range(Cells(1, last_column + 10), Cells(1, last_column + 12)) _    .Interior.Color = RGB(255, 0, 255)last_column = Range(Cells(1, 1), Cells(1, 1).End(xlToRight)).Count + 1'For i = 0 To UBound(vv_IV)''sh.Cells(1, last_column + i).Value = "IV Var " & vv_IV(i) & "d"''Next i'sh.Range(Cells(1, last_column), Cells(1, last_column + UBound(vv_IV))).Interior.Color = RGB(255, 0, 0)sh.Range(Cells(1, 1), Cells(1, 1).End(xlToRight)).Font.Bold = TrueEnd SubSub lins(main_r As Variant, sh As Worksheet)For i = 3 To UBound(main_r, 1) + 2 Step 2sh.Range(Cells(i, 1), Cells(i, UBound(main_r, 2) + 1)).Interior.Color = RGB(200, 255, 200)Next iEnd Sub
